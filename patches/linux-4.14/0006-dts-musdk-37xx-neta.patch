From f507b7b43e61cd901f03e17f12ec742af2040263 Mon Sep 17 00:00:00 2001
From: Liron Himi <lironh@marvell.com>
Date: Tue, 23 Oct 2018 23:09:26 +0300
Subject: [PATCH 6/8] dts: musdk 37xx neta

Signed-off-by: Liron Himi <lironh@marvell.com>
---
 arch/arm64/boot/dts/marvell/Makefile                    |  1 +
 arch/arm64/boot/dts/marvell/armada-3720-db-B-single.dts | 13 +++++++++++++
 arch/arm64/boot/dts/marvell/armada-37xx.dtsi            | 16 ++++++++++++++++
 3 files changed, 30 insertions(+)
 create mode 100644 arch/arm64/boot/dts/marvell/armada-3720-db-B-single.dts

diff --git a/arch/arm64/boot/dts/marvell/Makefile b/arch/arm64/boot/dts/marvell/Makefile
index e529a26..618ed4a 100644
--- a/arch/arm64/boot/dts/marvell/Makefile
+++ b/arch/arm64/boot/dts/marvell/Makefile
@@ -7,6 +7,7 @@ dtb-$(CONFIG_ARCH_BERLIN) += berlin4ct-stb.dtb
 dtb-$(CONFIG_ARCH_MVEBU) += armada-3720-db.dtb
 dtb-$(CONFIG_ARCH_MVEBU) += armada-3720-db-B.dtb
 dtb-$(CONFIG_ARCH_MVEBU) += armada-3720-db-C.dtb
+dtb-$(CONFIG_ARCH_MVEBU) += armada-3720-db-B-single.dtb
 dtb-$(CONFIG_ARCH_MVEBU) += armada-3720-espressobin.dtb
 dtb-$(CONFIG_ARCH_MVEBU) += armada-3720-espressobin-emmc.dtb
 dtb-$(CONFIG_ARCH_MVEBU) += armada-7040-db.dtb
diff --git a/arch/arm64/boot/dts/marvell/armada-3720-db-B-single.dts b/arch/arm64/boot/dts/marvell/armada-3720-db-B-single.dts
new file mode 100644
index 0000000..d4e8fc8
--- /dev/null
+++ b/arch/arm64/boot/dts/marvell/armada-3720-db-B-single.dts
@@ -0,0 +1,13 @@
+// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
+/*
+ * Device Tree file for Marvell Armada 3720 development board
+ * This board file supports the B configuration of the board
+ * Where Eth0 is user-space and Eth1 is kernel-space
+ */
+
+#include "armada-3720-db-B.dts"
+
+/* Set Eth1 as Kernel port */
+&eth1 {
+	/delete-property/musdk-status;
+};
\ No newline at end of file
diff --git a/arch/arm64/boot/dts/marvell/armada-37xx.dtsi b/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
index 3d3e1e5..c83e888 100644
--- a/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
+++ b/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
@@ -318,6 +318,7 @@
 				   interrupts = <GIC_SPI 42 IRQ_TYPE_LEVEL_HIGH>;
 				   clocks = <&sb_periph_clk 8>;
 				   status = "disabled";
+				   musdk-status = "private";
 			};
 
 			mdio: mdio@32004 {
@@ -333,6 +334,21 @@
 				interrupts = <GIC_SPI 45 IRQ_TYPE_LEVEL_HIGH>;
 				clocks = <&sb_periph_clk 7>;
 				status = "disabled";
+				musdk-status = "private";
+			};
+
+			uio_neta_0 {
+				compatible = "generic-uio";
+				reg = <0x30000 0x4000>;
+				reg-names = "neta_regs";
+				status = "okay";
+			};
+
+			uio_neta_1 {
+				compatible = "generic-uio";
+				reg = <0x40000 0x4000>;
+				reg-names = "neta_regs";
+				status = "okay";
 			};
 
 			usb3: usb@58000 {
-- 
2.7.4

